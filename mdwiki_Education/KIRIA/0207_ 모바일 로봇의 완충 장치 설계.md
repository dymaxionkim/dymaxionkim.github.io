# 7교시 : 문제 해결 예제 : 모바일 로봇의 완충 장치 설계

## 7.1. 조건

* 문제를 정의하고, Jupyter와 스크립트 프로그래밍으로 문제를 풀어보자.
* 프로그래밍 언어는 GNU Octave,
Scilab, Julia, Python 등 어떤 것이라도 다 가능하다.
* 여기서는 Julia를 사용해 본다.

## 7.2. 사전 지식 및 준비

* 자유물체도(FBD : Free Body Diagram)
* 선형시스템에 대한 기본적인 이해
* 스크립트
프로그래밍 환경에서 Control System 관련 도구의 구비

### FBD

* 동역학의 알파이자 오메가.
* FBD를 잘 그리면 모든 동역학 문제를 풀 수 있다.  못 그리면 어떤 동역학도 풀 수 없다.
* 뉴턴의 1,2,3법칙만 적용하면 된다.
* 물론 뉴턴 방식 말고, 라그랑쥬 방법도 있다. (힘 말고 위치-운동에너지 개념으로 접근하는 방법)
* 다만 숙달되지 않으면 잘못 그리기 쉬우므로 잘 그리자.
* 개념은 쉬운데 실제로 하려고 하면 막상 잘 안된다.
* 물론 실제 실무에서는,
FBD를 그리는 과정을 3D Model을 이용한 소프트웨어로 자동으로 처리해 준다고 보면 된다.

### 선형 시불변 시스템 (LTI : Linear Time Invarient System)

* 선형 : 균질성(Homogeneouty) +
중첩성(Superposition)
* 시불변 : $m$, $c$, $k$ 값이 상수라는 뜻.
* 미분방정식 : 위치($x$)를 시간($t$)으로
미분한다.
* 제일 간단한 물리 모델.
$$f = m \ddot{x} + c \dot{x} + kx$$

> $m$ : 질량.  질량은 가속도에
비례한 힘을 가진다. (Newton's 2nd Law)

> $c$ : 점성 계수.  점성 저항은 속도에 비례한 힘을 가진다. (Stokes'
Law)

> $k$ : 스프링 상수.  탄성 저항은 위치에 비례한 힘을 가진다. (Hook's Law)

### Transform Function

* Laplace Transform : Fourier Transform의 특수형.
*
시간영역(Time Domain) 미분방정식을 주파수영역(Frequency Domain)의 대수방정식으로 변환.
* 미분방정식 푸는 것 보다는
대수방정식 푸는 것이 훨씬 쉽다.
* 즉 문제를 간단하게 만들어주는 테크닉.
* 시스템을 기술한 미분방정식을 Laplace Transformn
한 것을 전달함수(Transform Function)이라고 부른다.

### Julia for LTI System

* 기본적으로, 이런 문제를 해결해 준다.

> 미분방정식을 전달함수로 한 방에 변환해 주는
명령이 있으면 좋겠다.

> 전달함수들을 이리저리 조합해서 시스템을 튜닝하기 쉬우면 좋겠다.

> 파라미터를 바꿔 가면서 시스템의 응답을
시뮬레이션 해 주면 좋겠다.

> 시뮬레이션한 결과를 다양하게 분석할 수 있으면 좋겠다.

### Julia Package for Control System

* Automatic Control with Julia course in
Lunds Univ.

> http://www.control.lth.se/Education/DoctorateProgram/julia-
course.html

* Control.jl 

> https://github.com/JuliaControl/Control.jl

## 7.3. 문제 정의하기

### 문제 정의하기

* 문제를 잘 정의하는 것이 가장 중요하다.
* 문제 정의에 실패하면 해답도 없다.
* 문제를 잘 정의하는 팁 :

>
"입력 - 출력" 개념으로 접근해 보자.

> 시스템의 특성을 조정할 수 있는 파라미터를 결정하자.

> "입력,출력,파라미터"에 관계되지 않는
사족(蛇足)은 다 버리자.  정신만 사나워진다.

> 설계 목표를 정량적으로 명확히 한다.  가장 좋은 방법은 성능지수를 설정하는 것이다.

### 모바일 로봇의 완충장치 설계 문제 정의하기

* 입력

> 주행중 바닥 요철에 의해 발생하는 진동 입력.  위치 값으로 정의하자.

*
출력

> 모바일 로봇의 본체의 운동.  역시 위치 값으로 정의하자.

* 파라미터

> 모바일 로봇의 질량, 완충장치의 댐핑계수, 완충장치의
스프링상수

* 사족 (고려하지 않아도 되는 것들)

> 바퀴의 회전 속도, 주행 속도...

* 설계 목표

> 출력이 발산하지 않을 것.
(Stability)

> 고주파 진동 입력을 출력에서 최대한 많이 컷오프 시킬 것. (Low Pass Filter)

### FBD 그리기

### 지배방정식 도출하기

* FBD를 보고 운동방정식을 써 본다.

## 7.4. Analysis with Julia

### 필요한 Julia Package 호출

* ControlSystems.jl 패키지 사용
* 저장소 :
https://github.com/JuliaControl/ControlSystems.jl
* 사용설명서 :
http://juliacontrol.github.io/ControlSystems.jl/latest/
* 설치 : Julia 커널 상태에서,
아래과 같이 명령을 줘서 패키지 설치

```python
Pkg.add("ControlSystems")
```

### 가장 간단한 분석의 예

* 전달함수 $P$를 정의하고, 푸리에 변환해서 주파수 분석 실시
* 최초 실행시에는 Pre-Compile
때문에 시간이 좀 걸림
* 웹브라우저 탭에 'Busy'라는 글자가 사라져야 완전히 끝난 것이므로 유의 필요

```python
using ControlSystems

P = tf(1,[1,1])^4
gangoffourplot(P,tf(1))

```

* 스텝 응답 보기

```python
stepplot(P)
```

### 입력, 출력, 파라미터 변수 설정

### 전달함수 만들기

### 시간영역 응답 분석

### 주파수영역 응답 분석

### 파라미터 바꿔가면서 응답의 변화 양상을 보기

### 설계 목표를 충족하는 파라미터 값을 결정

## 7.5. 해석 결과 활용

* 보고서 만들기 (pdf 생성)
* 웹에 보고서 올리기 (Gist에 올리기)
* 프리젠테이션 하기 (RISE
사용)
* 다른 도구와 연계

### 보고서 만들기 (pdf 생성)

### 웹에 보고서 올리기 (Gist에 올리기)

### 프리젠테이션 하기 (RISE 사용)

### 다른 도구와 연계

* 3D CAD에서 애니메이션

## 7.6. 마무으리

### 우리가 대체 무엇을 한 것인가

* 우리는 REPL 반복 과정을 통해, 하나의 완전한 문제해결 사이클을 완성했다!
* 이 과정은 훌륭한
'과학적 방법론'의 전형이다.
* 따라서 결과를 더 신뢰할 수 있게 되고, 만일 오류가 나중에 발견되더라도 쉽게 정정이 가능하다.
* 또한 가장
간단한 시스템을 분석했지만, 계속 버전업을 하면서 조건을 조금씩 덧붙여 나가면 나중에는 상당히 복잡한 시스템까지 다룰 수 있게 될 것이다.
